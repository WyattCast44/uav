<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UAV Simulator</title>
    <script type="module" crossorigin>var Kt=Object.defineProperty;var vt=o=>{throw TypeError(o)};var Xt=(o,t,a)=>t in o?Kt(o,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[t]=a;var n=(o,t,a)=>Xt(o,typeof t!="symbol"?t+"":t,a),qt=(o,t,a)=>t.has(o)||vt("Cannot "+a);var rt=(o,t,a)=>t.has(o)?vt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(o):t.set(o,a);var H=(o,t,a)=>(qt(o,t,"access private method"),a);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const e of s)if(e.type==="childList")for(const l of e.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function a(s){const e={};return s.integrity&&(e.integrity=s.integrity),s.referrerPolicy&&(e.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?e.credentials="include":s.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function i(s){if(s.ep)return;s.ep=!0;const e=a(s);fetch(s.href,e)}})();var it,bt,Tt;class jt{constructor(){rt(this,it);n(this,"canvas");n(this,"context");n(this,"target");n(this,"isMounted",!1);n(this,"dpr",1);n(this,"displayWidth",0);n(this,"displayHeight",0);n(this,"currentTime",null);n(this,"displayItems",[]);this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.dpr=window.devicePixelRatio||1,this.context.scale(this.dpr,this.dpr),this.clear(),H(this,it,Tt).call(this)}clear(){this.context.clearRect(0,0,this.displayWidth,this.displayHeight)}setTarget(t){this.target=t}mount(){if(!this.target)throw new Error("Target element not found");if(this.isMounted){console.warn("HUDCanvas is already mounted");return}this.target.appendChild(this.canvas),this.displayWidth=this.canvas.clientWidth,this.displayHeight=this.canvas.clientHeight,this.isMounted=!0}unmount(){var t;if(!this.target)throw new Error("Target element not found");if(!this.isMounted){console.warn("HUDCanvas is not mounted");return}(t=this.target)==null||t.removeChild(this.canvas),this.isMounted=!1}render(t){this.clear(),H(this,it,bt).call(this),this.currentTime=t||null,this.displayItems.forEach(a=>{a()})}addRenderableItem(t){this.displayItems.push(t)}}it=new WeakSet,bt=function(){this.displayWidth=this.canvas.clientWidth,this.displayHeight=this.canvas.clientHeight,this.canvas.width=this.displayWidth*this.dpr,this.canvas.height=this.displayHeight*this.dpr,this.context.scale(this.dpr,this.dpr)},Tt=function(){let t={position:"absolute",top:"0",left:"0",width:"100%",height:"100%"};Object.assign(this.canvas.style,t),window.addEventListener("resize",this.render.bind(this,this.currentTime||void 0))};class q{constructor(t){n(this,"value");this.value=t}static fromMeters(t){return new q(t*3.28084)}get feet(){return this.value}get meters(){return this.value*.3048}get nauticalMiles(){return this.value*164579e-9}get kilometers(){return this.value*.00030480031}}class _t{constructor(t){n(this,"value");this.value=t}get meters(){return this.value}get kilometers(){return this.value*.001}get feet(){return this.value*3.28084}get nauticalMiles(){return this.value*539957e-9}}function zt(o){return o*(Math.PI/180)}function nt(o,t,a,i){const s=zt(i);return{x:o+a*Math.cos(s),y:t+a*Math.sin(s)}}function Mt(o){return o=(o-1)%360+1,o==0&&(o=360),o<1&&(o+=360),o}function R(o,t,a){const i=a*Math.PI/180,s=Math.cos(i),e=Math.sin(i),l=o.x-t.x,r=o.y-t.y;return{x:t.x+(l*s-r*e),y:t.y+(l*e+r*s)}}class U{constructor(t){n(this,"value");this.value=t}get knots(){return this.value}get kilometersPerSecond(){return this.value*.000514444444}get kilometersPerMinute(){return this.value*.0308666}get kilometersPerHour(){return this.value*1.852}get metersPerSecond(){return this.value*.514444444}get metersPerMinute(){return this.value*30.8666}get metersPerHour(){return this.value*1852}get feetPerSecond(){return this.value*1.687809857}get feetPerMinute(){return this.value*101.268591424}get feetPerHour(){return this.value*6076.1154855643}}class L{constructor(t){n(this,"value");this.value=t}static fromRadians(t){return new L(t*(180/Math.PI))}get degrees(){return this.value}get radians(){return this.value*(Math.PI/180)}}class Y{constructor(t){n(this,"value");this.value=Mt(t)}static fromDegrees(t){return new Y(t)}static fromRadians(t){return new Y(t*(180/Math.PI))}get degrees(){return this.value}get radians(){return this.value*(Math.PI/180)}}class tt{constructor(t,a="F"){n(this,"temperature");n(this,"units");this.temperature=t,this.units=a}static standardDayAtSeaLevel(t="F"){return t==="F"?new tt(68):new tt(20)}static fromFahrenheit(t){return new tt(t,"F")}static fromCelsius(t){return new tt(t*(9/5)+32,"F")}get temperatureFahrenheit(){if(this.units==="F")return this.temperature;if(this.units==="C")return this.temperature*(9/5)+32;throw new Error("Invalid units")}get temperatureCelsius(){if(this.units==="F")return(this.temperature-32)*(5/9);if(this.units==="C")return this.temperature;throw new Error("Invalid units")}}class J{constructor(t,a="ft/s^2"){n(this,"value");n(this,"units");this.value=t,this.units=a}static fromFeetPerSecondSquared(t){return new J(t,"ft/s^2")}static fromMetersPerSecondSquared(t){return new J(t,"m/s^2")}get ftPerSecondSquared(){return this.convertTo("ft/s^2").value}get metersPerSecondSquared(){return this.convertTo("m/s^2").value}convertTo(t){if(this.units===t)return this;let a=this.units;if(a==="ft/s^2"&&t==="m/s^2")return new J(this.value*.3048,t);if(a==="m/s^2"&&t==="ft/s^2")return new J(this.value*3.28084,t);throw new Error(`Unsupported units: ${a}`)}}class xt{static get ftPerSecondSquaredAtSeaLevel(){return new J(32.174049,"ft/s^2")}static get metersPerSecondSquaredAtSeaLevel(){return new J(9.80665,"m/s^2")}static estimateGravityAtAltitude(t,a){let i=new _t(6378100),s=this.metersPerSecondSquaredAtSeaLevel.metersPerSecondSquared*Math.pow(i.meters/(i.meters+t.meters),2);return new J(s,"m/s^2").convertTo(a)}}class Ct{constructor({direction:t=new Y(0),speed:a=new U(0)}){n(this,"cardinalDirection");n(this,"speed");this.cardinalDirection=t instanceof Y?t:new Y(t),this.speed=a instanceof U?a:new U(a)}get directionFromCardinal(){return this.cardinalDirection}get directionFromCardinalRadians(){return this.directionFromCardinal.radians}get directionFromMath(){return 90-this.cardinalDirection.degrees}get directionFromMathRadians(){return new L(this.directionFromMath).radians}get directionToCardinal(){return(this.cardinalDirection.degrees-180)%360}get directionToCardinalRadians(){return new Y(this.directionToCardinal).radians}get directionToMath(){return 90-(this.cardinalDirection.degrees-180)%360}get directionToMathRadians(){return new L(this.directionToMath).radians}get windNorthComponent(){return new U(this.speed.knots*Math.cos(this.directionToCardinalRadians))}get windEastComponent(){return new U(this.speed.knots*Math.sin(this.directionToCardinalRadians))}}class Jt{constructor({wind:t=new Ct({direction:0,speed:0}),surfaceTemperature:a=tt.standardDayAtSeaLevel("F")}){n(this,"wind");n(this,"surfaceTemperature");this.wind=t,this.surfaceTemperature=a}setWind(t){this.wind=t}setSurfaceTemperature(t){this.surfaceTemperature=t}estimateAirDensityAtAltitude(t){return 1.22+-3.39*Math.pow(10,-5)*t.feet+2.8*Math.pow(10,-10)*Math.pow(t.feet,2)}}class Rt{constructor({maxAltitude:t,maxBankAngle:a,maxLoadFactor:i,maxGamma:s}){n(this,"maxAltitude");n(this,"maxBankAngle");n(this,"maxLoadFactor");n(this,"maxGamma");this.maxAltitude=t,this.maxBankAngle=a,this.maxLoadFactor=i,this.maxGamma=s}}class At{constructor({rollRate:t,rollRateCompensator:a,pitchRate:i,pitchRateCompensator:s,accelKeasPerSecond:e,accelKnotsPerSecondCompensator:l}){n(this,"rollRate");n(this,"rollRateCompensator");n(this,"pitchRate");n(this,"pitchRateCompensator");n(this,"accelKeasPerSecond");n(this,"accelKnotsPerSecondCompensator");this.rollRate=t,this.rollRateCompensator=a,this.pitchRate=i,this.pitchRateCompensator=s,this.accelKeasPerSecond=e,this.accelKnotsPerSecondCompensator=l}get effectiveRollRate(){return this.rollRate*this.rollRateCompensator}get effectivePitchRate(){return this.pitchRate*this.pitchRateCompensator}get effectiveAccelKeasPerSecond(){return this.accelKeasPerSecond*this.accelKnotsPerSecondCompensator}}var z=(o=>(o.FULL="FULL",o.HALF="HALF",o.IN="IN",o.LOCKED="LOCKED",o.NONE="NONE",o))(z||{}),ut=(o=>(o.DOWN="down",o.UP="up",o.TRANSIT="transit",o))(ut||{}),ot=(o=>(o.MANUAL="manual",o.AUTOPILOT="autopilot",o.MSN="msn",o))(ot||{});const Qt=Math.PI/180,Zt=180/Math.PI;function kt(o){return o*Qt}function wt(o){return o*Zt}var D,Pt,Lt,Ft,Dt,$t,It,Gt,Wt,Ht;class te{constructor(t){rt(this,D);n(this,"uav");n(this,"heading",new Y(360));n(this,"keas",new U(0));n(this,"altitude",new q(0));n(this,"gamma",new L(0));n(this,"bank",new L(0));n(this,"ktas",new U(0));n(this,"mach",0);n(this,"groundSpeed",new U(0));n(this,"course",new Y(0));n(this,"loadFactor",0);n(this,"experiencedGravity",xt.ftPerSecondSquaredAtSeaLevel);n(this,"turnRate",0);n(this,"turnRadius",new q(0));n(this,"verticalVelocity",0);n(this,"controlMode",ot.MANUAL);n(this,"gearStatus",ut.UP);n(this,"boardsStatus",z.NONE);n(this,"position",{x:0,y:0});this.uav=t}setIntialAttitude({heading:t,keas:a,altitude:i,gamma:s,bank:e,position:l}){this.heading=t instanceof Y?t:new Y(t),this.keas=a instanceof U?a:new U(a),this.altitude=i instanceof q?i:new q(i),this.gamma=s instanceof L?s:new L(s),this.bank=e instanceof L?e:new L(e),this.position=l}updatePerformanceValues(t){this.ktas=H(this,D,Pt).call(this,t),this.mach=H(this,D,Lt).call(this),this.groundSpeed=H(this,D,Ft).call(this,t),this.course=H(this,D,Dt).call(this,t),this.loadFactor=H(this,D,$t).call(this),this.experiencedGravity=H(this,D,It).call(this),this.turnRate=H(this,D,Gt).call(this),this.turnRadius=H(this,D,Wt).call(this),this.verticalVelocity=H(this,D,Ht).call(this)}}D=new WeakSet,Pt=function(t){return new U(Math.round(this.keas.knots*Math.sqrt(1.225/t.estimateAirDensityAtAltitude(this.altitude))))},Lt=function(){return parseFloat((this.ktas.knots/((-1.2188*(this.altitude.feet/1e3)+341.59)*1.944)).toFixed(2))},Ft=function(t){let a=this.ktas.knots*Math.cos(this.heading.radians),i=this.ktas.knots*Math.sin(this.heading.radians),s=t.wind.windNorthComponent,e=t.wind.windEastComponent,l=a+s.knots,r=i+e.knots,m=Math.sqrt(Math.pow(l,2)+Math.pow(r,2));return new U(Math.round(m))},Dt=function(t){let a=this.ktas.knots*Math.cos(this.heading.radians),i=this.ktas.knots*Math.sin(this.heading.radians),s=t.wind.windNorthComponent.knots,e=t.wind.windEastComponent.knots,l=a+s,r=i+e,m=Math.atan2(r,l),d=wt(m);return new Y(Math.round(d))},$t=function(){return parseFloat((1/Math.cos(this.bank.radians)).toFixed(2))},It=function(){return xt.estimateGravityAtAltitude(this.altitude,"ft/s^2")},Gt=function(){let t=wt(this.experiencedGravity.convertTo("m/s^2").value*Math.tan(this.bank.radians)/this.ktas.metersPerSecond);return parseFloat(t.toFixed(2))},Wt=function(){let t=Math.pow(this.ktas.feetPerSecond,2)/(this.experiencedGravity.convertTo("ft/s^2").value*Math.sqrt(Math.pow(this.loadFactor,2)-1));return new q(parseFloat(t.toFixed(4)))},Ht=function(){let a=this.groundSpeed.feetPerSecond*60*Math.sin(this.gamma.radians);return parseFloat(a.toFixed(2))};class ee{constructor(t){n(this,"keas");n(this,"gamma");n(this,"bank");n(this,"gearStatus");n(this,"boardsStatus");n(this,"bankRate",0);n(this,"pitchRate",0);n(this,"airspeedRate",0);this.uav=t}updateFromKeyboardInputs(t){const a=this.uav.controller,i=this.uav.dynamics,s=this.uav.limits,e=t/1e3;if(a.commands.rollLeft?this.bankRate=-i.effectiveRollRate:a.commands.rollRight?this.bankRate=i.effectiveRollRate:this.bankRate=0,a.commands.pitchUp?this.pitchRate=i.effectivePitchRate:a.commands.pitchDown?this.pitchRate=-i.effectivePitchRate:this.pitchRate=0,a.commands.throttleUp?this.airspeedRate=i.effectiveAccelKeasPerSecond:a.commands.throttleDown?this.airspeedRate=-i.effectiveAccelKeasPerSecond:this.airspeedRate=0,this.bankRate!==0&&(this.bank=new L(this.uav.state.bank.degrees+this.bankRate*e)),this.pitchRate!==0&&(this.gamma=new L(this.uav.state.gamma.degrees+this.pitchRate*e)),this.airspeedRate!==0&&(this.keas=new U(this.uav.state.keas.knots+this.airspeedRate*e)),this.bank){const l=this.bank.degrees+this.bankRate*e;this.bank=new L(Math.max(-s.maxBankAngle.degrees,Math.min(s.maxBankAngle.degrees,l)))}if(this.gamma){const l=this.gamma.degrees+this.pitchRate*e;this.gamma=new L(Math.max(-s.maxGamma.degrees,Math.min(s.maxGamma.degrees,l)))}if(this.keas){const l=this.keas.knots+this.airspeedRate*e;this.keas=new U(Math.max(0,l))}}}class ie{constructor(t="N/A",a){n(this,"state",new te(this));n(this,"commandedAttitude",new ee(this));n(this,"dynamics",new At({rollRate:10,rollRateCompensator:1,pitchRate:10,pitchRateCompensator:1,accelKeasPerSecond:1,accelKnotsPerSecondCompensator:1}));n(this,"limits",new Rt({maxAltitude:new q(1e4),maxBankAngle:new L(60),maxLoadFactor:8,maxGamma:new L(60)}));n(this,"controller");this.tailNumber=t,this.controller=a}}class se extends ie{constructor(a="MQ9",i){super(a,i);n(this,"boardsStatus",z.IN);n(this,"dynamics",new At({rollRate:15,rollRateCompensator:1,pitchRate:10,pitchRateCompensator:.2,accelKeasPerSecond:1,accelKnotsPerSecondCompensator:1}));n(this,"limits",new Rt({maxAltitude:new q(5e4),maxBankAngle:new L(45),maxLoadFactor:2.5,maxGamma:new L(45)}))}}class ae{constructor(t,a){this.uav=t,this.uavState=a,this.uav=t}estimateAttitudeBasedOnTimeIncrement(t){const a=t/1e3,i=this.uav.commandedAttitude,s=this.uav.dynamics;if(i.bank!==void 0){const e=this.uavState.bank.degrees,r=i.bank.degrees-e,m=s.effectiveRollRate*a,d=e+Math.max(-m,Math.min(m,r));this.uavState.bank=new L(d)}if(i.gamma!==void 0){const e=this.uavState.gamma.degrees,r=i.gamma.degrees-e,m=s.effectivePitchRate*a,d=e+Math.max(-m,Math.min(m,r));this.uavState.gamma=new L(d)}if(i.keas!==void 0){const e=this.uavState.keas.knots,r=i.keas.knots-e,m=s.effectiveAccelKeasPerSecond*a,d=e+Math.max(-m,Math.min(m,r));this.uavState.keas=new U(d)}if(this.uav.state.gamma.degrees!==0){const e=this.uavState.altitude.feet,m=this.uav.state.verticalVelocity/60*a,d=e+m;this.uavState.altitude=new q(d)}}}var mt,Et;class re{constructor(t,a,i){rt(this,mt);n(this,"uav");n(this,"environment");n(this,"simulation");n(this,"canvas");n(this,"controlMode");n(this,"primaryGraphicsColor","green");n(this,"secondaryGraphicsColor","black");n(this,"primaryTextColor","white");n(this,"secondaryTextColor","white");this.uav=t,this.environment=a,this.simulation=i,this.canvas=new jt,this.controlMode=t.state.controlMode,H(this,mt,Et).call(this)}getFont(t){return`${t}px monospace`}mount(t){this.canvas.setTarget(t),this.canvas.mount()}unmount(){this.canvas.unmount()}render(t){this.canvas.render(t)}}mt=new WeakSet,Et=function(){switch(this.controlMode){case ot.MANUAL:this.primaryGraphicsColor="lime",this.secondaryGraphicsColor="black",this.primaryTextColor="white",this.secondaryTextColor="lime";break;case ot.AUTOPILOT:this.primaryGraphicsColor="blue",this.secondaryGraphicsColor="black",this.primaryTextColor="white",this.secondaryTextColor="white";break;case ot.MSN:this.primaryGraphicsColor="green",this.secondaryGraphicsColor="black",this.primaryTextColor="white",this.secondaryTextColor="white";break}};var K,Ot,Ut,Nt,Bt,Yt;class ne extends re{constructor(a,i,s){super(a,i,s);rt(this,K);this.canvas.addRenderableItem(this.renderAirspeed.bind(this)),this.canvas.addRenderableItem(this.renderAltitude.bind(this)),this.canvas.addRenderableItem(this.renderVerticalSpeed.bind(this)),this.canvas.addRenderableItem(this.renderTailNumber.bind(this)),this.canvas.addRenderableItem(this.renderGroundSpeed.bind(this)),this.canvas.addRenderableItem(this.renderMach.bind(this)),this.canvas.addRenderableItem(this.renderGForce.bind(this)),this.canvas.addRenderableItem(this.renderBankIndicator.bind(this)),this.canvas.addRenderableItem(this.renderClock.bind(this)),this.canvas.addRenderableItem(this.renderSimulationTime.bind(this)),this.canvas.addRenderableItem(this.renderWind.bind(this)),this.canvas.addRenderableItem(this.renderHeadingBar.bind(this)),this.canvas.addRenderableItem(this.renderPitchLadder.bind(this)),this.canvas.addRenderableItem(this.renderFlightPathMarker.bind(this)),this.canvas.addRenderableItem(this.renderPosition.bind(this))}renderAirspeed(){this.uav.state.gearStatus===ut.UP?H(this,K,Ot).call(this):H(this,K,Ut).call(this)}renderAltitude(){this.uav.state.gearStatus===ut.UP?H(this,K,Nt).call(this):H(this,K,Bt).call(this)}renderVerticalSpeed(){let a=this.canvas,i=a.displayWidth/6*5,s=a.displayHeight/2+40,e=this.canvas.context;e.font=this.getFont(15),e.fillStyle=this.secondaryTextColor,e.textAlign="center",e.fillText(this.uav.state.verticalVelocity.toFixed(0),i,s)}renderPosition(){let a=this.canvas,i=this.canvas.context,s=a.displayWidth/6*5,e=a.displayHeight/2+60,l=this.uav.state.position,r="X: "+l.x,m="Y: "+l.y;i.font=this.getFont(10),i.fillStyle=this.primaryTextColor,i.fillText(r,s,e),i.fillText(m,s,e+15)}renderTailNumber(){let a=38,i=30,s=this.canvas.context;s.strokeStyle=this.primaryGraphicsColor,s.lineWidth=1;let e=60,l=28;s.strokeRect(a-e/2,i-l/2-7,e,l),s.fillStyle=this.secondaryGraphicsColor,s.fillRect(a-e/2,i-l/2-7,e,l),s.font=this.getFont(20),s.fillStyle=this.primaryTextColor,s.textAlign="center",s.fillText(this.uav.tailNumber,a,i)}renderGroundSpeed(){let a=this.canvas,i=a.displayWidth/6-10,s=a.displayHeight/2+40,e=this.canvas.context;e.font=this.getFont(15),e.fillStyle=this.secondaryTextColor,e.textAlign="left",e.fillText("GS "+this.uav.state.groundSpeed.value.toFixed(0),i,s)}renderMach(){let a=this.canvas,i=a.displayWidth/6-10,s=a.displayHeight/2+60,e=this.canvas.context;e.font=this.getFont(15),e.fillStyle=this.secondaryTextColor,e.textAlign="left",e.fillText("M "+this.uav.state.mach.toFixed(2),i,s)}renderGForce(){let a=this.canvas,i=a.displayWidth/6-10,s=a.displayHeight/2+80,e=this.canvas.context;e.font=this.getFont(15),e.fillStyle=this.secondaryTextColor,e.textAlign="left",e.fillText("G  "+this.uav.state.loadFactor.toFixed(1),i,s)}renderBankIndicator(){let a=this.canvas,i=a.displayWidth/2,s=a.displayHeight-230,e=150,l=[-60,-45,-30,-20,-10,0,10,20,30,45,60],r=this.canvas.context,m=[];for(let k of l){let p=k%45===0?15:k%10===0?10:7;(k===45||k===-45)&&(Math.abs(this.uav.state.bank.degrees)>=30?p=15:p=0),(k===60||k===-60)&&(Math.abs(this.uav.state.bank.degrees)>=45?p=20:p=0);let w=nt(i,s,e,k+90),A=nt(i,s,e-p,k+90);m.push({start:w,end:A,length:p,angle:k})}for(let k of m)r.beginPath(),r.strokeStyle=this.primaryGraphicsColor,r.lineWidth=1,r.moveTo(k.start.x,k.start.y),r.lineTo(k.end.x,k.end.y),r.stroke();let d=this.uav.state.bank.degrees+90,C=nt(i,s,e+4,d),y=nt(i,s,e+12,d-2.5),b=nt(i,s,e+12,d+2.5);r.beginPath(),r.strokeStyle=this.primaryGraphicsColor,r.lineWidth=1,r.moveTo(y.x,y.y),r.lineTo(C.x,C.y),r.lineTo(b.x,b.y),r.closePath(),r.fillStyle=this.primaryGraphicsColor,r.fill(),r.stroke()}renderClock(){if(!this.canvas.currentTime)return;let a=this.canvas,i=a.displayWidth/6*5,s=a.displayHeight-a.displayHeight+110,e=this.canvas.context,l=this.canvas.currentTime,r=l.getHours().toString().padStart(2,"0"),m=l.getMinutes().toString().padStart(2,"0"),d=l.getSeconds().toString().padStart(2,"0"),C=`${r}:${m}:${d}`;e.font=this.getFont(15),e.fillStyle=this.primaryTextColor,e.textAlign="center",e.fillText(C,i,s)}renderSimulationTime(){let a=this.canvas,i=a.displayWidth/6*5,s=a.displayHeight-a.displayHeight+130,e=this.canvas.context;e.font=this.getFont(15),e.fillStyle=this.primaryTextColor,e.textAlign="center",e.fillText(this.simulation.getDuration(),i,s)}renderWind(){let a=this.canvas,i=a.displayWidth/6,s=a.displayHeight-a.displayHeight/6*5,e=this.canvas.context,l=this.environment.wind.cardinalDirection.degrees,r=this.environment.wind.speed,m=i,d=s,C=30,y=(l-this.uav.state.heading.degrees)%360-180,b={x:m,y:d},k={x:m,y:d+C},p={x:m-C/6,y:d+C/4},w={x:m+C/6,y:d+C/4};b=R(b,b,y),k=R(k,b,y),p=R(p,b,y),w=R(w,b,y),e.strokeStyle=this.primaryGraphicsColor,e.lineWidth=1,e.beginPath(),e.moveTo(b.x,b.y),e.lineTo(k.x,k.y),e.moveTo(b.x,b.y),e.lineTo(p.x,p.y),e.lineTo(w.x,w.y),e.closePath(),e.fillStyle=this.primaryGraphicsColor,e.fill(),e.stroke();let A=b.x,P=k.y+25;(P<b.y||Math.abs(P-b.y)<20)&&(P=b.y+20),e.font=this.getFont(12),e.fillStyle=this.primaryTextColor,e.textAlign="center",e.fillText(l.toFixed(0)+"° "+r.value.toFixed(0),A,P)}getLadderWidth(a){return{0:225,2.5:100,5:140,10:140,15:140,20:140,25:140,30:140,35:140,40:140,45:140}[Math.abs(a)]}renderPitchLadder(){let a=[0,5,10,15,20,25,30,35,40,45,-5,-10,-15,-20,-25,-30,-35,-40,-45];for(let i of a)H(this,K,Yt).call(this,i)}renderFlightPathMarker(){let a=this.canvas,i=this.canvas.context,s={x:a.displayWidth/2,y:a.displayHeight/2},e=a.displayHeight/23,l=s.x,r=s.y,m=8,d=14;r=r-this.uav.state.gamma.degrees*e;const y=R({x:l,y:r},s,this.uav.state.bank.degrees/2),b={start:{x:y.x,y:y.y-m},end:{x:y.x,y:y.y-m-d}},k={start:{x:y.x-m,y:y.y},end:{x:y.x-m-d,y:y.y}},p={start:{x:y.x+m,y:y.y},end:{x:y.x+m+d,y:y.y}},w={start:R(b.start,y,this.uav.state.bank.degrees/2),end:R(b.end,y,this.uav.state.bank.degrees/2)},A={start:R(k.start,y,this.uav.state.bank.degrees/2),end:R(k.end,y,this.uav.state.bank.degrees/2)},P={start:R(p.start,y,this.uav.state.bank.degrees/2),end:R(p.end,y,this.uav.state.bank.degrees/2)};if(i.beginPath(),i.arc(y.x,y.y,m,kt(0),kt(360),!0),i.stroke(),i.beginPath(),i.strokeStyle=this.primaryGraphicsColor,i.lineWidth=1,i.moveTo(w.start.x,w.start.y),i.lineTo(w.end.x,w.end.y),i.stroke(),i.beginPath(),i.strokeStyle=this.primaryGraphicsColor,i.lineWidth=1,i.moveTo(A.start.x,A.start.y),i.lineTo(A.end.x,A.end.y),i.stroke(),i.beginPath(),i.strokeStyle=this.primaryGraphicsColor,i.lineWidth=1,i.moveTo(P.start.x,P.start.y),i.lineTo(P.end.x,P.end.y),i.stroke(),this.uav.state.boardsStatus===z.NONE)return;let B={start:R({x:A.start.x-m,y:A.end.y+(A.start.y-A.end.y)+3},y,this.uav.state.bank.degrees/2),end:R({x:A.start.x-m,y:(A.start.y-A.end.y)/2+A.end.y},y,this.uav.state.bank.degrees/2)},S=15,$=30,I=0;switch(this.uav.state.boardsStatus){case z.FULL:I=$;break;case z.HALF:I=S;break;case z.IN:I=0;break;default:I=0;break}if(i.beginPath(),i.strokeStyle=this.primaryGraphicsColor,i.lineWidth=1,i.moveTo(B.start.x,B.start.y),i.lineTo(B.end.x,B.end.y+I),i.stroke(),this.uav.state.boardsStatus===z.LOCKED){let E={x:A.start.x-m/2-d+2,y:A.end.y},X={x:P.start.x+m/2+d-2,y:P.end.y};i.beginPath(),i.arc(E.x,E.y,2.5,0,Math.PI*2),i.fillStyle=this.primaryGraphicsColor,i.fill(),i.stroke(),i.beginPath(),i.arc(X.x,X.y,2.5,0,Math.PI*2),i.fillStyle=this.primaryGraphicsColor,i.fill(),i.stroke()}}renderHeadingBar(){let i=this.canvas.displayWidth/2,s=35,e=this.canvas.context,l=i,r=s+20,m=270,d=8,C=m/60,y=d,b=d*.5,k=[],p=[],w=this.uav.state.heading.degrees,A=this.uav.state.course.degrees;for(let S=-30;S<=31;S++){let $=w+S;$=Mt($),$=parseFloat($.toFixed(0));let I=S*C;if($===A){let E={x:I+l,y:r+10},X={x:I-5+l,y:r+15},j={x:I+5+l,y:r+15};e.beginPath(),e.strokeStyle=this.primaryGraphicsColor,e.lineWidth=1,e.moveTo(X.x,X.y),e.lineTo(E.x,E.y),e.lineTo(j.x,j.y),e.closePath(),e.stroke(),E={x:l+.5,y:r+1},X={x:l+.5-5,y:r-3},j={x:l+.5+5,y:r-3},e.beginPath(),e.strokeStyle=this.primaryGraphicsColor,e.lineWidth=1,e.moveTo(X.x,X.y),e.lineTo(E.x,E.y),e.lineTo(j.x,j.y),e.closePath(),e.fillStyle=this.primaryGraphicsColor,e.fill(),e.stroke()}$%10===0&&k.push({x:I,y:r,height:y}),$%5===0&&k.push({x:I,y:r+b,height:b+3}),$%10===0&&S!==0&&Math.abs(S)>6&&p.push({x:I,y:r,text:$.toString().slice(0,2).padStart(2,"0")})}for(let S of k)e.fillStyle=this.primaryGraphicsColor,e.fillRect(S.x+l,S.y-S.height,1,S.height);for(let S of p)e.fillStyle=this.primaryTextColor,e.font=this.getFont(10),e.fillText(S.text,S.x+l,S.y-14);let P=40,B=20;e.strokeStyle=this.primaryGraphicsColor,e.lineWidth=1,e.strokeRect(i-P/2,s-B/2-6,P,B),e.fillStyle="black",e.fillRect(i-P/2,s-B/2-6,P,B),e.font=this.getFont(15),e.fillStyle=this.primaryTextColor,e.textAlign="center",e.fillText(w.toFixed(0).padStart(3,"0"),i,s-1)}}K=new WeakSet,Ot=function(){let a=this.canvas,i=a.displayWidth/6,s=a.displayHeight/2,e=this.canvas.context;e.font=this.getFont(20),e.fillStyle=this.primaryTextColor,e.textAlign="center",e.fillText(this.uav.state.keas.value.toFixed(0),i,s),e.strokeStyle=this.primaryGraphicsColor,e.lineWidth=1;let l=80,r=28;e.strokeRect(i-l/2,s-r/2-7,l,r)},Ut=function(){let a=this.canvas,i=a.displayWidth/6+15,s=a.displayHeight/2-20,e=i-0,l=s+6,r=this.canvas.context;r.font=this.getFont(20),r.fillStyle=this.primaryTextColor,r.textAlign="center",r.fillText(this.uav.state.keas.value.toFixed(0),e,l);let m=30,d=m/3,C=m/10;r.beginPath(),r.setLineDash([d,C]),r.strokeStyle=this.primaryGraphicsColor,r.lineWidth=1,r.arc(i,s,m,0,Math.PI*2),r.stroke(),r.setLineDash([])},Nt=function(){let a=this.canvas,i=a.displayWidth/6*5,s=a.displayHeight/2,e=this.canvas.context;e.font=this.getFont(20),e.fillStyle=this.primaryTextColor,e.textAlign="center",e.fillText(this.uav.state.altitude.value.toFixed(0),i,s),e.strokeStyle=this.primaryGraphicsColor,e.lineWidth=1;let l=80,r=28;e.strokeRect(i-l/2,s-r/2-7,l,r)},Bt=function(){let a=this.canvas,i=a.displayWidth/6*5,s=a.displayHeight/2-25,e=i-0,l=s+7,r=this.canvas.context;r.font=this.getFont(20),r.fillStyle=this.primaryTextColor,r.textAlign="center",r.fillText(this.uav.state.altitude.value.toFixed(0),e,l);let m=40,d=m/3,C=m/10;r.beginPath(),r.setLineDash([d,C]),r.strokeStyle=this.primaryGraphicsColor,r.lineWidth=1,r.arc(i,s,m,0,Math.PI*2),r.stroke(),r.setLineDash([])},Yt=function(a){let i=this.canvas,s=this.canvas.context,e={x:i.displayWidth/2,y:i.displayHeight/2},l=85,r=this.getLadderWidth(a),m=i.displayHeight/23;m=a==0?0:m;let d={left:{start:{x:i.displayWidth/2-r,y:i.displayHeight/2+-a*m},end:{x:i.displayWidth/2-l/2,y:i.displayHeight/2+-a*m}},right:{start:{x:i.displayWidth/2+r,y:i.displayHeight/2+-a*m},end:{x:i.displayWidth/2+l/2,y:i.displayHeight/2+-a*m}},degree:a},C={x:(d.left.start.x+d.left.end.x)/2,y:(d.left.start.y+d.left.end.y)/2},y={x:(d.right.start.x+d.right.end.x)/2,y:(d.right.start.y+d.right.end.y)/2},b={start:R(d.left.start,C,d.degree/2),end:R(d.left.end,C,d.degree/2)},k={start:R(d.right.start,y,-d.degree/2),end:R(d.right.end,y,-d.degree/2)},p={start:R(b.start,e,this.uav.state.bank.degrees/2),end:R(b.end,e,this.uav.state.bank.degrees/2)};if(d.degree!==0){s.font=this.getFont(13),s.fillStyle=this.primaryTextColor,s.textAlign="center";let S=d.degree>0?p.start.y+18:p.start.y-10;s.fillText(a.toString(),p.start.x+12,S)}let w={start:R(k.start,e,this.uav.state.bank.degrees/2),end:R(k.end,e,this.uav.state.bank.degrees/2)};if(d.degree!==0){s.font=this.getFont(13),s.fillStyle=this.primaryTextColor,s.textAlign="center";let S=d.degree>0?w.start.y+18:w.start.y-10;s.fillText(a.toString(),w.start.x-12,S)}let A=3,P=4,B=(d.left.end.x-d.left.start.x-P)/A;if(d.degree>=0?s.setLineDash([]):s.setLineDash([B,P]),s.beginPath(),s.strokeStyle=this.primaryGraphicsColor,s.lineWidth=1,s.moveTo(p.start.x,p.start.y),s.lineTo(p.end.x,p.end.y),s.stroke(),s.beginPath(),s.strokeStyle=this.primaryGraphicsColor,s.lineWidth=1,s.moveTo(w.start.x,w.start.y),s.lineTo(w.end.x,w.end.y),s.stroke(),d.degree<0){let S=R({x:w.end.x,y:w.end.y-10},{x:w.end.x,y:w.end.y},this.uav.state.bank.degrees/2);s.beginPath(),s.strokeStyle=this.primaryGraphicsColor,s.lineWidth=1,s.moveTo(w.end.x,w.end.y),s.lineTo(S.x,S.y),s.stroke(),s.beginPath();let $=R({x:p.end.x,y:p.end.y-10},{x:p.end.x,y:p.end.y},this.uav.state.bank.degrees/2);s.beginPath(),s.strokeStyle=this.primaryGraphicsColor,s.lineWidth=1,s.moveTo(p.end.x,p.end.y),s.lineTo($.x,$.y),s.stroke()}else if(d.degree>0){let S=R({x:p.start.x,y:p.start.y+12},{x:p.start.x,y:p.start.y},this.uav.state.bank.degrees/2);s.beginPath(),s.strokeStyle=this.primaryGraphicsColor,s.lineWidth=1,s.moveTo(p.start.x,p.start.y),s.lineTo(S.x,S.y),s.stroke();let $=R({x:w.start.x,y:w.start.y+12},{x:w.start.x,y:w.start.y},this.uav.state.bank.degrees/2);s.beginPath(),s.strokeStyle=this.primaryGraphicsColor,s.lineWidth=1,s.moveTo(w.start.x,w.start.y),s.lineTo($.x,$.y),s.stroke()}s.setLineDash([])};function oe(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var ct={exports:{}},le=ct.exports,St;function he(){return St||(St=1,function(o,t){(function(a,i){o.exports=i()})(le,function(){var a=1e3,i=6e4,s=36e5,e="millisecond",l="second",r="minute",m="hour",d="day",C="week",y="month",b="quarter",k="year",p="date",w="Invalid Date",A=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,P=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,B={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(g){var u=["th","st","nd","rd"],h=g%100;return"["+g+(u[(h-20)%10]||u[h]||u[0])+"]"}},S=function(g,u,h){var f=String(g);return!f||f.length>=u?g:""+Array(u+1-f.length).join(h)+g},$={s:S,z:function(g){var u=-g.utcOffset(),h=Math.abs(u),f=Math.floor(h/60),c=h%60;return(u<=0?"+":"-")+S(f,2,"0")+":"+S(c,2,"0")},m:function g(u,h){if(u.date()<h.date())return-g(h,u);var f=12*(h.year()-u.year())+(h.month()-u.month()),c=u.clone().add(f,y),v=h-c<0,x=u.clone().add(f+(v?-1:1),y);return+(-(f+(h-c)/(v?c-x:x-c))||0)},a:function(g){return g<0?Math.ceil(g)||0:Math.floor(g)},p:function(g){return{M:y,y:k,w:C,d,D:p,h:m,m:r,s:l,ms:e,Q:b}[g]||String(g||"").toLowerCase().replace(/s$/,"")},u:function(g){return g===void 0}},I="en",E={};E[I]=B;var X="$isDayjsObject",j=function(g){return g instanceof ht||!(!g||!g[X])},lt=function g(u,h,f){var c;if(!u)return I;if(typeof u=="string"){var v=u.toLowerCase();E[v]&&(c=v),h&&(E[v]=h,c=v);var x=u.split("-");if(!c&&x.length>1)return g(x[0])}else{var M=u.name;E[M]=u,c=M}return!f&&c&&(I=c),c||!f&&I},G=function(g,u){if(j(g))return g.clone();var h=typeof u=="object"?u:{};return h.date=g,h.args=arguments,new ht(h)},T=$;T.l=lt,T.i=j,T.w=function(g,u){return G(g,{locale:u.$L,utc:u.$u,x:u.$x,$offset:u.$offset})};var ht=function(){function g(h){this.$L=lt(h.locale,null,!0),this.parse(h),this.$x=this.$x||h.x||{},this[X]=!0}var u=g.prototype;return u.parse=function(h){this.$d=function(f){var c=f.date,v=f.utc;if(c===null)return new Date(NaN);if(T.u(c))return new Date;if(c instanceof Date)return new Date(c);if(typeof c=="string"&&!/Z$/i.test(c)){var x=c.match(A);if(x){var M=x[2]-1||0,F=(x[7]||"0").substring(0,3);return v?new Date(Date.UTC(x[1],M,x[3]||1,x[4]||0,x[5]||0,x[6]||0,F)):new Date(x[1],M,x[3]||1,x[4]||0,x[5]||0,x[6]||0,F)}}return new Date(c)}(h),this.init()},u.init=function(){var h=this.$d;this.$y=h.getFullYear(),this.$M=h.getMonth(),this.$D=h.getDate(),this.$W=h.getDay(),this.$H=h.getHours(),this.$m=h.getMinutes(),this.$s=h.getSeconds(),this.$ms=h.getMilliseconds()},u.$utils=function(){return T},u.isValid=function(){return this.$d.toString()!==w},u.isSame=function(h,f){var c=G(h);return this.startOf(f)<=c&&c<=this.endOf(f)},u.isAfter=function(h,f){return G(h)<this.startOf(f)},u.isBefore=function(h,f){return this.endOf(f)<G(h)},u.$g=function(h,f,c){return T.u(h)?this[f]:this.set(c,h)},u.unix=function(){return Math.floor(this.valueOf()/1e3)},u.valueOf=function(){return this.$d.getTime()},u.startOf=function(h,f){var c=this,v=!!T.u(f)||f,x=T.p(h),M=function(Z,N){var _=T.w(c.$u?Date.UTC(c.$y,N,Z):new Date(c.$y,N,Z),c);return v?_:_.endOf(d)},F=function(Z,N){return T.w(c.toDate()[Z].apply(c.toDate("s"),(v?[0,0,0,0]:[23,59,59,999]).slice(N)),c)},W=this.$W,O=this.$M,V=this.$D,et="set"+(this.$u?"UTC":"");switch(x){case k:return v?M(1,0):M(31,11);case y:return v?M(1,O):M(0,O+1);case C:var Q=this.$locale().weekStart||0,st=(W<Q?W+7:W)-Q;return M(v?V-st:V+(6-st),O);case d:case p:return F(et+"Hours",0);case m:return F(et+"Minutes",1);case r:return F(et+"Seconds",2);case l:return F(et+"Milliseconds",3);default:return this.clone()}},u.endOf=function(h){return this.startOf(h,!1)},u.$set=function(h,f){var c,v=T.p(h),x="set"+(this.$u?"UTC":""),M=(c={},c[d]=x+"Date",c[p]=x+"Date",c[y]=x+"Month",c[k]=x+"FullYear",c[m]=x+"Hours",c[r]=x+"Minutes",c[l]=x+"Seconds",c[e]=x+"Milliseconds",c)[v],F=v===d?this.$D+(f-this.$W):f;if(v===y||v===k){var W=this.clone().set(p,1);W.$d[M](F),W.init(),this.$d=W.set(p,Math.min(this.$D,W.daysInMonth())).$d}else M&&this.$d[M](F);return this.init(),this},u.set=function(h,f){return this.clone().$set(h,f)},u.get=function(h){return this[T.p(h)]()},u.add=function(h,f){var c,v=this;h=Number(h);var x=T.p(f),M=function(O){var V=G(v);return T.w(V.date(V.date()+Math.round(O*h)),v)};if(x===y)return this.set(y,this.$M+h);if(x===k)return this.set(k,this.$y+h);if(x===d)return M(1);if(x===C)return M(7);var F=(c={},c[r]=i,c[m]=s,c[l]=a,c)[x]||1,W=this.$d.getTime()+h*F;return T.w(W,this)},u.subtract=function(h,f){return this.add(-1*h,f)},u.format=function(h){var f=this,c=this.$locale();if(!this.isValid())return c.invalidDate||w;var v=h||"YYYY-MM-DDTHH:mm:ssZ",x=T.z(this),M=this.$H,F=this.$m,W=this.$M,O=c.weekdays,V=c.months,et=c.meridiem,Q=function(N,_,at,dt){return N&&(N[_]||N(f,v))||at[_].slice(0,dt)},st=function(N){return T.s(M%12||12,N,"0")},Z=et||function(N,_,at){var dt=N<12?"AM":"PM";return at?dt.toLowerCase():dt};return v.replace(P,function(N,_){return _||function(at){switch(at){case"YY":return String(f.$y).slice(-2);case"YYYY":return T.s(f.$y,4,"0");case"M":return W+1;case"MM":return T.s(W+1,2,"0");case"MMM":return Q(c.monthsShort,W,V,3);case"MMMM":return Q(V,W);case"D":return f.$D;case"DD":return T.s(f.$D,2,"0");case"d":return String(f.$W);case"dd":return Q(c.weekdaysMin,f.$W,O,2);case"ddd":return Q(c.weekdaysShort,f.$W,O,3);case"dddd":return O[f.$W];case"H":return String(M);case"HH":return T.s(M,2,"0");case"h":return st(1);case"hh":return st(2);case"a":return Z(M,F,!0);case"A":return Z(M,F,!1);case"m":return String(F);case"mm":return T.s(F,2,"0");case"s":return String(f.$s);case"ss":return T.s(f.$s,2,"0");case"SSS":return T.s(f.$ms,3,"0");case"Z":return x}return null}(N)||x.replace(":","")})},u.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},u.diff=function(h,f,c){var v,x=this,M=T.p(f),F=G(h),W=(F.utcOffset()-this.utcOffset())*i,O=this-F,V=function(){return T.m(x,F)};switch(M){case k:v=V()/12;break;case y:v=V();break;case b:v=V()/3;break;case C:v=(O-W)/6048e5;break;case d:v=(O-W)/864e5;break;case m:v=O/s;break;case r:v=O/i;break;case l:v=O/a;break;default:v=O}return c?v:T.a(v)},u.daysInMonth=function(){return this.endOf(y).$D},u.$locale=function(){return E[this.$L]},u.locale=function(h,f){if(!h)return this.$L;var c=this.clone(),v=lt(h,f,!0);return v&&(c.$L=v),c},u.clone=function(){return T.w(this.$d,this)},u.toDate=function(){return new Date(this.valueOf())},u.toJSON=function(){return this.isValid()?this.toISOString():null},u.toISOString=function(){return this.$d.toISOString()},u.toString=function(){return this.$d.toUTCString()},g}(),gt=ht.prototype;return G.prototype=gt,[["$ms",e],["$s",l],["$m",r],["$H",m],["$W",d],["$M",y],["$y",k],["$D",p]].forEach(function(g){gt[g[1]]=function(u){return this.$g(u,g[0],g[1])}}),G.extend=function(g,u){return g.$i||(g(u,ht,G),g.$i=!0),G},G.locale=lt,G.isDayjs=j,G.unix=function(g){return G(1e3*g)},G.en=E[I],G.Ls=E,G.p={},G})}(ct)),ct.exports}var de=he();const ce=oe(de);class ue{constructor({uav:t,environment:a,startTime:i}){n(this,"uav");n(this,"environment");n(this,"startTime");n(this,"duration",0);n(this,"timeIncrement",0);n(this,"animationFrameId",null);n(this,"lastTimestamp",0);n(this,"renderCallback",null);n(this,"isRunning",!1);n(this,"hasBeenStarted",!1);n(this,"attitudeEstimator");this.uav=t,this.environment=a,this.startTime=i,this.attitudeEstimator=new ae(t,t.state),this.setupSpacebarListener()}setupSpacebarListener(){window.addEventListener("keyup",t=>{t.key===" "&&(this.hasBeenStarted?this.togglePause():this.start())})}togglePause(){this.isRunning?this.pause():this.resume()}setRenderCallback(t){this.renderCallback=t}updateUAVState(){this.isRunning&&(this.uav.commandedAttitude.updateFromKeyboardInputs(this.timeIncrement),this.attitudeEstimator.estimateAttitudeBasedOnTimeIncrement(this.timeIncrement),this.uav.state.updatePerformanceValues(this.environment))}getCurrentTime(){return this.startTime?ce(this.startTime).add(this.duration,"ms").toDate():null}animationLoop(t){if(!this.isRunning){this.animationFrameId=requestAnimationFrame(this.animationLoop.bind(this));return}if(this.lastTimestamp===0){this.lastTimestamp=t,this.animationFrameId=requestAnimationFrame(this.animationLoop.bind(this));return}const a=t-this.lastTimestamp;if(this.lastTimestamp=t,this.incrementTime(a),this.updateUAVState(),this.renderCallback){const i=this.getCurrentTime();i&&this.renderCallback(i)}this.animationFrameId=requestAnimationFrame(this.animationLoop.bind(this))}start(){this.startTime||(this.startTime=new Date),this.isRunning=!0,this.lastTimestamp=0,this.hasBeenStarted||(this.hasBeenStarted=!0,this.duration=0),this.animationFrameId||(this.animationFrameId=requestAnimationFrame(this.animationLoop.bind(this)))}pause(){this.isRunning=!1,this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}resume(){this.startTime&&(this.isRunning=!0,this.lastTimestamp=0,this.animationFrameId||(this.animationFrameId=requestAnimationFrame(this.animationLoop.bind(this))))}isSimulationRunning(){return this.isRunning}incrementTime(t){this.timeIncrement=t,this.duration+=this.timeIncrement}getDuration(){const t=Math.floor(this.duration/36e5),a=Math.floor(this.duration%(1e3*60*60)/(1e3*60)),i=Math.floor(this.duration%(1e3*60)/1e3);return`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}}class me{constructor(){n(this,"keys",{ArrowUp:!1,ArrowDown:!1,ArrowLeft:!1,ArrowRight:!1,Control:!1,Shift:!1,A:!1,S:!1});n(this,"commands",{pitchUp:!1,pitchDown:!1,rollLeft:!1,rollRight:!1,throttleUp:!1,throttleDown:!1});this.registerEventListeners()}registerEventListeners(){window.addEventListener("keydown",this.handleKeyDown.bind(this)),window.addEventListener("keyup",this.handleKeyUp.bind(this)),window.addEventListener("beforeunload",this.unregisterEventListeners.bind(this))}handleKeyDown(t){t.key==="Control"?this.keys.Control=!0:t.key==="ArrowUp"?(this.keys.ArrowUp=!0,this.commands.pitchUp=!0):t.key==="ArrowDown"?(this.keys.ArrowDown=!0,this.commands.pitchDown=!0):t.key==="ArrowLeft"?(this.keys.ArrowLeft=!0,this.commands.rollLeft=!0):t.key==="ArrowRight"?(this.keys.ArrowRight=!0,this.commands.rollRight=!0):t.key==="Shift"?this.keys.Shift=!0:t.key==="A"||t.key==="a"?(this.keys.A=!0,this.commands.throttleUp=!0):(t.key==="S"||t.key==="s")&&(this.keys.S=!0,this.commands.throttleDown=!0)}handleKeyUp(t){t.key==="Control"?this.keys.Control=!1:t.key==="ArrowUp"?(this.keys.ArrowUp=!1,this.commands.pitchUp=!1):t.key==="ArrowDown"?(this.keys.ArrowDown=!1,this.commands.pitchDown=!1):t.key==="ArrowLeft"?(this.keys.ArrowLeft=!1,this.commands.rollLeft=!1):t.key==="ArrowRight"?(this.keys.ArrowRight=!1,this.commands.rollRight=!1):t.key==="Shift"?this.keys.Shift=!1:t.key==="A"||t.key==="a"?(this.keys.A=!1,this.commands.throttleUp=!1):(t.key==="S"||t.key==="s")&&(this.keys.S=!1,this.commands.throttleDown=!1)}unregisterEventListeners(){window.removeEventListener("keydown",this.handleKeyDown.bind(this)),window.removeEventListener("keyup",this.handleKeyUp.bind(this)),window.removeEventListener("beforeunload",this.unregisterEventListeners.bind(this))}}let fe=new me,yt=new Jt({wind:new Ct({direction:270,speed:30}),surfaceTemperature:tt.standardDayAtSeaLevel("F")}),ft=new se("732",fe);ft.state.setIntialAttitude({heading:new Y(360),keas:new U(120),altitude:new q(2e4),gamma:new L(0),bank:new L(0),position:{x:0,y:0}});ft.state.updatePerformanceValues(yt);let Vt=new ue({uav:ft,environment:yt,startTime:null}),pt=new ne(ft,yt,Vt);pt.mount(document.getElementById("hud"));pt.render();Vt.setRenderCallback(o=>{pt.render(o)});</script>
    <style rel="stylesheet" crossorigin>/*! tailwindcss v4.0.15 | MIT License | https://tailwindcss.com */@layer theme{:root,:host{--font-sans:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--color-gray-500:oklch(.551 .027 264.364);--color-black:#000;--color-white:#fff;--spacing:.25rem;--default-transition-duration:.15s;--default-transition-timing-function:cubic-bezier(.4,0,.2,1);--default-font-family:var(--font-sans);--default-mono-font-family:var(--font-mono)}}@layer base{*,:after,:before,::backdrop{box-sizing:border-box;border:0 solid;margin:0;padding:0}::file-selector-button{box-sizing:border-box;border:0 solid;margin:0;padding:0}html,:host{-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;line-height:1.5;font-family:var(--default-font-family,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-feature-settings:var(--default-font-feature-settings,normal);font-variation-settings:var(--default-font-variation-settings,normal);-webkit-tap-highlight-color:transparent}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--default-mono-font-family,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-feature-settings:var(--default-mono-font-feature-settings,normal);font-variation-settings:var(--default-mono-font-variation-settings,normal);font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}:-moz-focusring{outline:auto}progress{vertical-align:baseline}summary{display:list-item}ol,ul,menu{list-style:none}img,svg,video,canvas,audio,iframe,embed,object{vertical-align:middle;display:block}img,video{max-width:100%;height:auto}button,input,select,optgroup,textarea{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}::file-selector-button{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}:where(select:is([multiple],[size])) optgroup{font-weight:bolder}:where(select:is([multiple],[size])) optgroup option{padding-inline-start:20px}::file-selector-button{margin-inline-end:4px}::placeholder{opacity:1}@supports (not ((-webkit-appearance:-apple-pay-button))) or (contain-intrinsic-size:1px){::placeholder{color:color-mix(in oklab,currentColor 50%,transparent)}}textarea{resize:vertical}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-date-and-time-value{min-height:1lh;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-datetime-edit{padding-block:0}::-webkit-datetime-edit-year-field{padding-block:0}::-webkit-datetime-edit-month-field{padding-block:0}::-webkit-datetime-edit-day-field{padding-block:0}::-webkit-datetime-edit-hour-field{padding-block:0}::-webkit-datetime-edit-minute-field{padding-block:0}::-webkit-datetime-edit-second-field{padding-block:0}::-webkit-datetime-edit-millisecond-field{padding-block:0}::-webkit-datetime-edit-meridiem-field{padding-block:0}:-moz-ui-invalid{box-shadow:none}button,input:where([type=button],[type=reset],[type=submit]){-webkit-appearance:button;-moz-appearance:button;appearance:button}::file-selector-button{-webkit-appearance:button;-moz-appearance:button;appearance:button}::-webkit-inner-spin-button{height:auto}::-webkit-outer-spin-button{height:auto}[hidden]:where(:not([hidden=until-found])){display:none!important}}@layer components;@layer utilities{.visible{visibility:visible}.absolute{position:absolute}.relative{position:relative}.static{position:static}.inset-0{inset:calc(var(--spacing)*0)}.top-0{top:calc(var(--spacing)*0)}.left-0{left:calc(var(--spacing)*0)}.container{width:100%}@media (width>=40rem){.container{max-width:40rem}}@media (width>=48rem){.container{max-width:48rem}}@media (width>=64rem){.container{max-width:64rem}}@media (width>=80rem){.container{max-width:80rem}}@media (width>=96rem){.container{max-width:96rem}}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.table{display:table}.aspect-square{aspect-ratio:1}.h-1{height:calc(var(--spacing)*1)}.h-1\/2{height:50%}.h-full{height:100%}.h-screen{height:100vh}.w-full{width:100%}.w-screen{width:100vw}.flex-1{flex:1}.resize{resize:both}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}:where(.space-y-2>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*2)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*2)*calc(1 - var(--tw-space-y-reverse)))}.overflow-hidden{overflow:hidden}.border{border-style:var(--tw-border-style);border-width:1px}.border-gray-500{border-color:var(--color-gray-500)}.bg-black{background-color:var(--color-black)}.p-2{padding:calc(var(--spacing)*2)}.text-white{color:var(--color-white)}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.shadow{--tw-shadow:0 1px 3px 0 var(--tw-shadow-color,#0000001a),0 1px 2px -1px var(--tw-shadow-color,#0000001a);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.blur{--tw-blur:blur(8px);filter:var(--tw-blur,)var(--tw-brightness,)var(--tw-contrast,)var(--tw-grayscale,)var(--tw-hue-rotate,)var(--tw-invert,)var(--tw-saturate,)var(--tw-sepia,)var(--tw-drop-shadow,)}.transition{transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to,opacity,box-shadow,transform,translate,scale,rotate,filter,-webkit-backdrop-filter,backdrop-filter;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}@media (width>=64rem){.lg\:flex{display:flex}.lg\:flex-row{flex-direction:row}:where(.lg\:space-y-0>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*0)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*0)*calc(1 - var(--tw-space-y-reverse)))}:where(.lg\:space-x-2>:not(:last-child)){--tw-space-x-reverse:0;margin-inline-start:calc(calc(var(--spacing)*2)*var(--tw-space-x-reverse));margin-inline-end:calc(calc(var(--spacing)*2)*calc(1 - var(--tw-space-x-reverse)))}}@media print{.print\:hidden{display:none}}}canvas{font-family:monospace}@property --tw-space-y-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-shadow-color{syntax:"*";inherits:false}@property --tw-inset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-shadow-color{syntax:"*";inherits:false}@property --tw-ring-color{syntax:"*";inherits:false}@property --tw-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-ring-color{syntax:"*";inherits:false}@property --tw-inset-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-ring-inset{syntax:"*";inherits:false}@property --tw-ring-offset-width{syntax:"<length>";inherits:false;initial-value:0}@property --tw-ring-offset-color{syntax:"*";inherits:false;initial-value:#fff}@property --tw-ring-offset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-blur{syntax:"*";inherits:false}@property --tw-brightness{syntax:"*";inherits:false}@property --tw-contrast{syntax:"*";inherits:false}@property --tw-grayscale{syntax:"*";inherits:false}@property --tw-hue-rotate{syntax:"*";inherits:false}@property --tw-invert{syntax:"*";inherits:false}@property --tw-opacity{syntax:"*";inherits:false}@property --tw-saturate{syntax:"*";inherits:false}@property --tw-sepia{syntax:"*";inherits:false}@property --tw-drop-shadow{syntax:"*";inherits:false}@property --tw-space-x-reverse{syntax:"*";inherits:false;initial-value:0}</style>
  </head>
  <body>
    <div
      class="h-screen w-screen overflow-hidden bg-black text-white antialiased"
    >
      <div
        class="w-full h-full p-2 flex items-center justify-center space-y-2 flex-col"
      >
        <div class="flex flex-col lg:flex-row space-y-2 lg:space-y-0 lg:space-x-2 flex-1 h-full w-full overflow-hidden">
          <!-- hud -->
          <div
            id="hud"
            class="flex-1 border border-gray-500 flex items-center justify-center relative h-full aspect-square"
          ></div>

          <!-- virtual world -->
          <div
            id="virtual-world"
            class="flex-1 border border-gray-500 flex items-center justify-center relative w-full h-full"
          >
            <div class="absolute top-0 left-0 p-2">
              <p>Press <kbd>Space</kbd> to start/stop the simulation</p>
              <p>Press <kbd>Right/Left Arrow</kbd> to bank</p>
              <p>Press <kbd>Up/Down Arrow</kbd> to pitch</p>
              <p>Press <kbd>A</kbd> to throttle up</p>
              <p>Press <kbd>S</kbd> to throttle down</p>
            </div>
        </div>
        </div>

        <!-- map -->
        <div
          id="map"
          class="w-full h-1/2 border border-gray-500 items-center justify-center print:hidden hidden lg:flex"
        ></div>
      </div>
    </div>
  </body>
</html>
